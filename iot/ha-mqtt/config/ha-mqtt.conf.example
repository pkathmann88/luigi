# /etc/luigi/iot/ha-mqtt/ha-mqtt.conf
# Home Assistant MQTT Integration Configuration
#
# This file configures the Luigi MQTT bridge for Home Assistant integration.
# Set permissions to 600 (owner read/write only) to protect credentials:
#   sudo chmod 600 /etc/luigi/iot/ha-mqtt/ha-mqtt.conf

[Broker]
# MQTT broker connection settings
HOST=homeassistant.local
PORT=1883
# For TLS encryption, use port 8883 and set TLS=yes
TLS=no
# Optional: Path to CA certificate for TLS
# CA_CERT=/etc/ssl/certs/ca-certificates.crt

[Authentication]
# MQTT broker authentication
# Create a user in your MQTT broker for Luigi
USERNAME=luigi
PASSWORD=your_secure_password_here
# Note: Change the password above and set file permissions to 600

[Client]
# MQTT client settings
# CLIENT_ID will be expanded with hostname automatically
CLIENT_ID=luigi_${HOSTNAME}
KEEPALIVE=60
# Quality of Service: 0 (at most once), 1 (at least once), 2 (exactly once)
QOS=1
# Clean session (yes=no persistence, no=persistent session)
CLEAN_SESSION=yes

[Topics]
# Topic structure for Luigi messages
# Default topic pattern: homeassistant/sensor/luigi-{HOSTNAME}/{sensor_id}/state
BASE_TOPIC=homeassistant
DISCOVERY_PREFIX=homeassistant
DEVICE_PREFIX=luigi
# ${HOSTNAME} is automatically expanded to the system hostname

[Device]
# Device information for Home Assistant
# This appears as a device in Home Assistant with all sensors grouped under it
DEVICE_NAME=Luigi ${HOSTNAME}
DEVICE_MODEL=Raspberry Pi Zero W
MANUFACTURER=Luigi Project
SW_VERSION=1.0

[Connection]
# Connection behavior and timeouts
RECONNECT_DELAY_MIN=5
RECONNECT_DELAY_MAX=300
CONNECTION_TIMEOUT=10

[Discovery]
# Sensor discovery and registration
# Directory where modules place their sensor descriptor JSON files
SENSORS_DIR=/etc/luigi/iot/ha-mqtt/sensors.d
# Scan interval for new sensors (seconds) - used by optional Python service
SCAN_INTERVAL=300

[Logging]
# Logging configuration
LOG_FILE=/var/log/luigi/ha-mqtt.log
LOG_LEVEL=INFO
LOG_MAX_BYTES=10485760
LOG_BACKUP_COUNT=5

# Configuration Examples:
#
# Example 1: Local broker with default settings
#   HOST=localhost
#   PORT=1883
#   USERNAME=luigi
#   PASSWORD=your_password
#
# Example 2: Remote broker with TLS
#   HOST=mqtt.example.com
#   PORT=8883
#   TLS=yes
#   CA_CERT=/etc/ssl/certs/ca-certificates.crt
#   USERNAME=luigi
#   PASSWORD=your_secure_password
#
# Example 3: Home Assistant add-on broker
#   HOST=homeassistant.local
#   PORT=1883
#   USERNAME=luigi
#   PASSWORD=your_password
#
# After editing this file:
#   1. Set secure permissions: sudo chmod 600 /etc/luigi/iot/ha-mqtt/ha-mqtt.conf
#   2. Test connection: luigi-mqtt-status
#   3. Discover sensors: sudo luigi-discover
#   4. Publish test value: luigi-publish --sensor test --value 42
